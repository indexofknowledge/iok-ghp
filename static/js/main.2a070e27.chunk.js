(this["webpackJsonpindex-of-knowledge"]=this["webpackJsonpindex-of-knowledge"]||[]).push([[0],{414:function(e,t,a){e.exports=a(894)},419:function(e,t,a){},433:function(e,t){},435:function(e,t){},446:function(e,t){},448:function(e,t){},459:function(e,t){},461:function(e,t){},569:function(e,t){},627:function(e,t){},691:function(e,t,a){},881:function(e,t,a){},885:function(e,t,a){},887:function(e,t,a){},888:function(e,t,a){},889:function(e,t,a){},890:function(e,t,a){},893:function(e,t,a){},894:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(69),l=a.n(r),c=a(900),i=a(13),s=a(22),d=a(17),u=a(24),p=a(23),h=(a(419),a(66)),f="blockstack",b="ipfs",m=1,g=2,v=1,y=new h.AppConfig(["store_write","publish_data"]),k=b,E={hash:"QmWm3A6EdXYD12eaEjADs7iPnraEaYmK788QEHumQZ7yrH"},O=[{user:"rustielin.id.blockstack",app:"https://index-of-knowledge.firebaseapp.com/?loaduser=rustielin.id.blockstack"},{user:"rustielintest.id.blockstack",app:"https://index-of-knowledge-beta.firebaseapp.com/?loaduser=rustielintest.id.blockstack"}],C={nodes:[{data:{name:"math",node_type:1,id:"0ed8f58bf8b3ae5ba6b882961eff9068c84268522fdf1b9a7fdc90cae0e9a703"}},{data:{name:"computer science",node_type:1,id:"48cd5a52518c7054ade553b6e0eb991d315ecfe96164b44c13dc47269c954982"}},{data:{name:"economics",node_type:1,id:"a4be61c650fefcc75b406cbf120212a6ffe71c3a983f64e603e1b823e575abbb"}},{data:{name:"bitcoin",node_type:1,id:"04eaf9a2a65d37f254fab35f969da7b133cea2087e1be846ea2dc8ccbb0e2470"}},{data:{resource_type:1,data:{text:"Computer science is the study of processes that interact with data and that can be represented as data in the form of programs.",link:""},node_type:2,id:"8d3e61ce168c16ae5c10fc0eb2085e7063844736be62d37c1318b437e60a06b2",name:"res-8d3e61ce16"}},{data:{resource_type:1,data:{text:"Economics is the social science that studies the production, distribution, and consumption of goods and services.",link:""},node_type:2,id:"71686ead6a4dc2481870877da6a888fab7c488819572c391b71acabd047930fe",name:"res-71686ead6a"}},{data:{resource_type:1,data:{text:"Mathematics is the study of abstract objects and structures that are often, but not always, abstracted from the physical world. It includes the study of such abstractions as quantity, structure, space and shapes, and change.",link:""},node_type:2,id:"4fba4eba5e774c7a67c951001f27784d63116b4fc182b9977254bd1223e185a1",name:"res-4fba4eba5e"}},{data:{resource_type:1,data:{text:"Bitcoin is an innovative payment network and a new kind of money.",link:""},node_type:2,id:"e6f043e27913e1ceb469bfbcc6eca983a374918618c4912e65f4756f6e177855",name:"res-e6f043e279"}},{data:{resource_type:4,data:{text:"Bitcoin: A Peer-to-Peer Electronic Cash System",link:"https://bitcoin.org/bitcoin.pdf"},node_type:2,id:"5e71f1ce88b810081fc39b4aae938593e8ddf086d93b544ae83c51bcb2905319",name:"res-5e71f1ce88"}}],edges:[{data:{source:"48cd5a52518c7054ade553b6e0eb991d315ecfe96164b44c13dc47269c954982",target:"04eaf9a2a65d37f254fab35f969da7b133cea2087e1be846ea2dc8ccbb0e2470",id:"0f366f92-58ca-4f29-b942-da41ca8863c7"}},{data:{source:"0ed8f58bf8b3ae5ba6b882961eff9068c84268522fdf1b9a7fdc90cae0e9a703",target:"04eaf9a2a65d37f254fab35f969da7b133cea2087e1be846ea2dc8ccbb0e2470",id:"090d2ffb-9a72-4660-a7a7-247119ba47a0"}},{data:{source:"a4be61c650fefcc75b406cbf120212a6ffe71c3a983f64e603e1b823e575abbb",target:"04eaf9a2a65d37f254fab35f969da7b133cea2087e1be846ea2dc8ccbb0e2470",id:"27ef1ee0-344b-4961-9afd-3639e32c6736"}},{data:{source:"8d3e61ce168c16ae5c10fc0eb2085e7063844736be62d37c1318b437e60a06b2",target:"48cd5a52518c7054ade553b6e0eb991d315ecfe96164b44c13dc47269c954982",id:"3a33c7c3-714a-4da4-a1e4-dbcc1cd1c86b"}},{data:{source:"71686ead6a4dc2481870877da6a888fab7c488819572c391b71acabd047930fe",target:"a4be61c650fefcc75b406cbf120212a6ffe71c3a983f64e603e1b823e575abbb",id:"92369729-24e4-4f83-9aa0-a72667cf9191"}},{data:{source:"4fba4eba5e774c7a67c951001f27784d63116b4fc182b9977254bd1223e185a1",target:"0ed8f58bf8b3ae5ba6b882961eff9068c84268522fdf1b9a7fdc90cae0e9a703",id:"1f3f5e7e-bf90-43ba-ace5-0fbfe462872b"}},{data:{source:"e6f043e27913e1ceb469bfbcc6eca983a374918618c4912e65f4756f6e177855",target:"04eaf9a2a65d37f254fab35f969da7b133cea2087e1be846ea2dc8ccbb0e2470",id:"649c601a-dd57-42a9-ba1f-5053c37152e0"}},{data:{source:"5e71f1ce88b810081fc39b4aae938593e8ddf086d93b544ae83c51bcb2905319",target:"04eaf9a2a65d37f254fab35f969da7b133cea2087e1be846ea2dc8ccbb0e2470",id:"53e2e0a4-a766-4b9e-a88a-a87c7d293772"}}]},S=[{selector:"node[name]",style:{"background-color":"#f8be35",label:"data(name)"}},{selector:"edge",style:{width:4,"target-arrow-shape":"triangle","line-color":"#FFE6A9","target-arrow-color":"#FFE6A9","curve-style":"bezier"}},{selector:".selected",style:{"background-color":"#E8747C"}},{selector:".highlighted",style:{"background-color":"#75b5aa","line-color":"#75b5aa","target-arrow-color":"#75b5aa","transition-property":"background-color, line-color, target-arrow-color","transition-duration":"0.5s"}},{selector:".altHighlighted",style:{"background-color":"#E8747C","line-color":"#E8747C","target-arrow-color":"#E8747C","transition-property":"background-color, line-color, target-arrow-color","transition-duration":"0.5s"}},{selector:".eh-handle",style:{"background-color":"red",width:12,height:12,shape:"ellipse","overlay-opacity":0,"border-width":12,"border-opacity":0}},{selector:".eh-hover",style:{"background-color":"red"}},{selector:".eh-source",style:{"border-width":2,"border-color":"red"}},{selector:".eh-target",style:{"border-width":2,"border-color":"red"}},{selector:".eh-preview, .eh-ghost-edge",style:{"background-color":"red","line-color":"red","target-arrow-color":"red","source-arrow-color":"red"}},{selector:".eh-ghost-edge.eh-preview-active",style:{opacity:0}}],N=(a(691),function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;return Object(s.a)(this,a),(e=t.call(this)).userSession=new h.UserSession({appConfig:y}),e}return Object(d.a)(a,[{key:"signIn",value:function(e){e.preventDefault(),this.userSession.redirectToSignIn()}},{key:"render",value:function(){var e=this.props.guestModeHandler;return o.a.createElement("div",{className:"Landing"},o.a.createElement("div",{className:"form-signin"},o.a.createElement("h1",{className:"h1 mb-3 font-weight-normal"},"Index of Knowledge"),o.a.createElement("button",{type:"button",className:"btn btn-lg btn-primary btn-block",onClick:this.signIn.bind(this)},"Sign in with Blockstack"),o.a.createElement("button",{type:"button",className:"btn btn-lg btn-primary btn-block",onClick:e},"Continue as guest")))}}]),a}(n.Component));N.defaultProps={guestModeHandler:function(){return alert("ERROR: guestModeHandler() invalid")}};var w=N,j=a(9),R=a(410),T=a(898),M=a(411),D=a(122),G=a.n(D),L=a(398),I=a.n(L),F=a(399),x=a.n(F),H=a(400),P=a.n(H),_=a(897),B=(a(881),function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){var e=this.props,t=e.storage,n=e.options,r=e.changeLoadUser,l=e.signOut;return o.a.createElement("nav",{className:"navbar navbar-expand-md navbar-dark bg-blue fixed-top"},o.a.createElement(_.a,{className:"navbar-brand",onClick:function(){return a.onHomeClick(t,n,r)},to:"/"},"Index of Knowledge"),o.a.createElement("ul",{className:"navbar-nav mr-auto"},o.a.createElement("li",{className:"nav-item"},a.greetingBuilder(t,n))),o.a.createElement("p",{className:"navbar-nav mr-auto"}),a.selectStorageBuilder(t),a.signOutBuilder(t,n,l.bind(this)))}}],[{key:"paramsBuilder",value:function(e){var t="/";for(var a in e)""!==t&&(t+="&"),t+="".concat(a,"=").concat(encodeURIComponent(e[a]));return t}},{key:"onHomeClick",value:function(e,t,n){switch(e){case f:n(t.username);break;case b:window.location.href=a.paramsBuilder(E)}}},{key:"greetingBuilder",value:function(e,t){switch(e){case f:return"Viewing ".concat(t.loaduser,"'s IoK, logged in as ").concat(t.username);case b:return t.hash;default:return"Hello"}}},{key:"signOutBuilder",value:function(e,t,a){switch(e){case f:return o.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:a},"Sign","guest"===t.username?" in":" out");case b:return"";default:return"Hello"}}},{key:"selectStorageBuilder",value:function(e){switch(e){case f:return o.a.createElement("button",{type:"button",className:"btn btn-info btn-lg btn-util",onClick:function(){window.location.href="/?storage=".concat(b)}},"Try IPFS!");case b:return o.a.createElement("button",{type:"button",className:"btn btn-info btn-lg btn-util",onClick:function(){window.location.href="/?storage=".concat(f)}},"Try Blockstack!");default:return"Hello"}}}]),a}(n.Component));B.defaultProps={storage:k,options:E,changeLoadUser:function(){return alert("ERROR: changeLoadUser() invalid")},signOut:function(){return alert("ERROR: signOut() invalid")}};var U=B,A=a(409),J=a(401),z=a(899),K=a(38),$=a.n(K),q=a(167),V=a(402),Q=a.n(V),W={trace:"lightblue",info:"green",warn:"pink",error:"red"},Y=new(function(){function e(){Object(s.a)(this,e)}return Object(d.a)(e,[{key:"generateMessage",value:function(e,t,a){var n="".concat("iok",":").concat(e),o=Q()(n);o.color=W[e],a?o(a,t):o(t)}},{key:"trace",value:function(e,t){return this.generateMessage("trace",e,t)}},{key:"info",value:function(e,t){return this.generateMessage("info",e,t)}},{key:"warn",value:function(e,t){return this.generateMessage("warn",e,t)}},{key:"error",value:function(e,t){return this.generateMessage("error",e,t)}}]),e}()),X="listen",Z=null,ee=!1,te=null,ae=null,ne=!1,oe=function(e){var t=e.json(),a=t.elements.nodes,n=t.elements.edges;if(!a||!n)return{nodes:[],edges:[]};for(var o=0;o<a.length;o+=1)a[o]={data:a[o].data};for(var r=0;r<n.length;r+=1)n[r]={data:n[r].data};return{nodes:a,edges:n}},re=function(e){var t={elements:oe(e)};return t.style=e.style,t},le=function(e){e.fit()},ce=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return te&&te.stop(),(te=e.layout({name:t?"cola":"dagre",animate:!0,padding:50,animationDuration:300,nodeDimensionsIncludeLabels:!0})).run(),new Promise((function(){le(e)}))},ie=function(e){var t=e.nodes("[node_type > 1]");if(0!==t.length){var a="none";"none"===t[0].style("display")&&(a="element");for(var n=0;n<t.length;n+=1)t[n].style("display",a)}},se=function(e){e.removeClass("highlighted"),e.removeClass("altHighlighted")},de=function(){var e=Object(q.a)($.a.mark((function e(t){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.removeClass("selected"),t.unselect();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ue=function(){var e=Object(q.a)($.a.mark((function e(t){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.addClass("highlighted");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pe=function(){var e=Object(q.a)($.a.mark((function e(t){return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.addClass("altHighlighted");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),he=function(e){return e!==ae},fe=function(e,t){!function(e){e.nodes().forEach(se),e.edges().forEach(se),e.nodes().forEach(de),e.edges().forEach(de)}(e),ae=t,ne=!1;var a=function e(t,a){if(null===t)return null.collection();for(var n=a.add(t),o=t.incomers(),r=0,l=0;l<o.length;l+=1){var c=o[l];n.contains(c)||(r+=(n=n.add(e(c,n))).length)}return r<o.length-1&&(ne=!0,alert("Oh no! We have a dependency cycle...")),n}(t,e.collection());ne?a.filter(he).forEach(pe):a.filter(he).forEach(ue),t.addClass("selected")},be=(a(885),function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={isOpen:!1,nodeType:0,topicName:"",resourceType:0},n.toggleModal=n.toggleModal.bind(Object(j.a)(n)),n.handleClose=n.handleClose.bind(Object(j.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(j.a)(n)),n}return Object(d.a)(a,[{key:"toggleModal",value:function(){var e=this.state.isOpen;this.setState({isOpen:!e})}},{key:"handleClose",value:function(){this.setState({isOpen:!1,nodeType:0,topicName:"",resourceType:0,resourceData:null}),this.toggleModal()}},{key:"handleSubmit",value:function(){var e=this.state,t=e.nodeType,a=e.topicName,n=e.resourceType,o=e.resourceData,r={};if(0!==t){if(1===t){if(0===a.length)return void alert("Missing topic name");r={name:a}}else{if(0===n)return void alert("Missing resource type");if(r={resource_type:n,data:o},n>1){if(!o.text||0===o.text.length)return void alert("Missing resource text");if(!(l=o.link,!!new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(l)))return void alert("Invalid URL")}}var l;r.node_type=t,(0,this.props.addNode)(r),this.toggleModal()}else alert("Missing node type")}},{key:"pickedNode",value:function(){return 0===this.state.nodeType?o.a.createElement("p",null,"Pick a node type please"):this.fillInNode()}},{key:"fillInNode",value:function(){var e=this;return 1===this.state.nodeType?o.a.createElement(z.a.Group,null,o.a.createElement(z.a.Label,null,"Topic Name"),o.a.createElement(z.a.Control,{type:"text",placeholder:"Bitcoin",onChange:function(t){return e.setState({topicName:t.target.value})}})):o.a.createElement(z.a.Group,null,o.a.createElement(z.a.Label,null,"Resource data"),o.a.createElement(z.a.Group,null,o.a.createElement(z.a.Check,{type:"radio",name:"radioResourceType",label:"Description",onClick:function(){return e.setState({resourceType:1,resourceData:{}})}}),o.a.createElement(z.a.Check,{type:"radio",name:"radioResourceType",label:"Article",onClick:function(){return e.setState({resourceType:2,resourceData:{}})}}),o.a.createElement(z.a.Check,{type:"radio",name:"radioResourceType",label:"Video",onClick:function(){return e.setState({resourceType:3,resourceData:{}})}}),o.a.createElement(z.a.Check,{type:"radio",name:"radioResourceType",label:"Paper",onClick:function(){return e.setState({resourceType:4,resourceData:{}})}})),this.topicOrResource())}},{key:"topicOrResource",value:function(){var e=this,t=this.state.resourceType;return 0===t||1===t?o.a.createElement("div",null,o.a.createElement(z.a.Control,{type:"text",placeholder:"Bitcoin is a p2p cash system",onChange:function(t){e.setState({resourceData:{text:t.target.value,link:null}})}}),o.a.createElement(z.a.Control.Feedback,{type:"invalid"},"Please provide valid resource data"),o.a.createElement(z.a.Text,null,"Resource data can be a description or hyperlink")):o.a.createElement("div",null,o.a.createElement(z.a.Control,{type:"text",placeholder:"Bitcoin whitepaper",onChange:function(t){var a=t.target.value;e.setState((function(e){return{resourceData:Object(i.a)(Object(i.a)({},e.resourceData),{},{text:a})}}))}}),o.a.createElement(z.a.Control.Feedback,{type:"invalid"},"Please provide valid resource link name"),o.a.createElement(z.a.Text,null,"Resource link name"),o.a.createElement(z.a.Control,{type:"url",placeholder:"https://bitcoin.org/bitcoin.pdf",onChange:function(t){var a=t.target.value;e.setState((function(e){return{resourceData:Object(i.a)(Object(i.a)({},e.resourceData),{},{link:a})}}))}}),o.a.createElement(z.a.Control.Feedback,{type:"invalid"},"Please provide valid resource link"),o.a.createElement(z.a.Text,null,"Resource link URL"))}},{key:"render",value:function(){var e=this,t=this.state.isOpen;return o.a.createElement("div",null,o.a.createElement(M.a,{className:"btn btn-info btn-lg btn-mod",onClick:this.toggleModal},"Add node"),o.a.createElement(T.a,{className:"Modal",show:t,onHide:this.handleClose},o.a.createElement(T.a.Header,{closeButton:!0},o.a.createElement(T.a.Title,null,"Add Node")),o.a.createElement(T.a.Body,null,o.a.createElement(z.a.Label,null,"Node type"),o.a.createElement(z.a.Group,null,o.a.createElement(z.a.Check,{type:"radio",name:"radioNodeType",label:"Topic",onClick:function(){return e.setState({nodeType:1})}}),o.a.createElement(z.a.Check,{type:"radio",name:"radioNodeType",label:"Resource",onClick:function(){return e.setState({nodeType:2})}})),this.pickedNode()),o.a.createElement(T.a.Footer,null,o.a.createElement(M.a,{style:{backgroundColor:"#a9a8a8"},variant:"primary",type:"submit",onClick:this.handleSubmit},"Add node"))))}}]),a}(n.Component));be.defaultProps={addNode:function(){return alert("ERROR: addNode() invalid")}};var me=be,ge=a(901),ve=a(407),ye=(a(887),function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var n;Object(s.a)(this,a);var o=(n=t.call(this,e)).props.addNode;return n.state=Object(i.a)({isOpen:!1},n.setStateFromNode()),n.addNode=o,n.toggleModal=n.toggleModal.bind(Object(j.a)(n)),n.handleClose=n.handleClose.bind(Object(j.a)(n)),n.handleOpen=n.handleOpen.bind(Object(j.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(j.a)(n)),n.setResourceType=n.setResourceType.bind(Object(j.a)(n)),n}return Object(d.a)(a,[{key:"setStateFromNode",value:function(){var e=this.props.node;return{topicName:e?e.data("name"):"",resourceType:e?e.data("resource_type"):0,resourceData:e?e.data("data"):{}}}},{key:"setResourceType",value:function(e){this.setState({resourceType:e})}},{key:"toggleModal",value:function(){var e=this.state.isOpen;this.setState({isOpen:!e})}},{key:"handleOpen",value:function(){this.setState(Object(i.a)({isOpen:!0},this.setStateFromNode()))}},{key:"handleClose",value:function(){this.setState({isOpen:!1}),this.toggleModal()}},{key:"handleSubmit",value:function(){this.toggleModal();var e=this.props,t=e.node,a=e.addNode,n=e.setNode,o=e.updateEdges,r=e.removeNode,l=Object(i.a)({},t.data()),c=this.state,s=c.resourceType,d=c.resourceData,u=c.topicName;if(l.resource_type=s,l.data=d,u&&(l.name=u),JSON.stringify(l)!==JSON.stringify(t.data())){2===l.node_type&&delete l.name,delete l.id;var p=a(l);n(p),o(t,p),p.shift(t.position()),p.trigger("tap"),r(t)}}},{key:"topicOrResource",value:function(){var e=this,t=this.props.node,a=this.state,n=a.topicName,r=a.resourceType;return t.data("node_type")===m?o.a.createElement(z.a.Group,null,o.a.createElement(z.a.Label,null,"Topic Name"),o.a.createElement(z.a.Control,{type:"text",placeholder:"Bitcoin",value:n,onChange:function(t){return e.setState({topicName:t.target.value})}})):o.a.createElement(z.a.Group,null,o.a.createElement(z.a.Label,null,"Resource data"),o.a.createElement(ge.a,{type:"radio",name:"idk",value:r,onChange:this.setResourceType},o.a.createElement(ve.a,{value:1},"Description"),o.a.createElement(ve.a,{value:2},"Article"),o.a.createElement(ve.a,{value:3},"Video"),o.a.createElement(ve.a,{value:4},"Paper")),this.descOrLink())}},{key:"descOrLink",value:function(){var e=this,t=this.state,a=t.resourceType,n=t.resourceData;return 0===a||a===v?o.a.createElement("div",null,o.a.createElement(z.a.Control,{id:"abc",name:"abc",type:"text",placeholder:"Bitcoin is a p2p cash system",value:n.text,onChange:function(t){var a=t.target.value;e.setState((function(e){return{resourceData:Object(i.a)(Object(i.a)({},e.resourceData),{},{text:a})}}))}}),o.a.createElement(z.a.Control.Feedback,{type:"invalid"},"Please provide valid resource data"),o.a.createElement(z.a.Text,null,"Resource data can be a description or hyperlink")):o.a.createElement("div",null,o.a.createElement(z.a.Control,{type:"text",placeholder:"Bitcoin whitepaper",value:n?n.text:null,onChange:function(t){var a=t.target.value;e.setState((function(e){return{resourceData:Object(i.a)(Object(i.a)({},e.resourceData),{},{text:a})}}))}}),o.a.createElement(z.a.Control.Feedback,{type:"invalid"},"Please provide valid resource link name"),o.a.createElement(z.a.Text,null,"Resource link name"),o.a.createElement(z.a.Control,{type:"url",placeholder:"https://bitcoin.org/bitcoin.pdf",value:n?n.link:null,onChange:function(t){var a=t.target.value;e.setState((function(e){return{resourceData:Object(i.a)(Object(i.a)({},e.resourceData),{},{link:a})}}))}}),o.a.createElement(z.a.Control.Feedback,{type:"invalid"},"Please provide valid resource link"),o.a.createElement(z.a.Text,null,"Resource link URL"))}},{key:"render",value:function(){var e=this.props.node,t=this.state.isOpen;return e?o.a.createElement("span",null,o.a.createElement(M.a,{className:"btn btn-info btn-lg btn-mod",onClick:this.toggleModal},"Edit node"),o.a.createElement(T.a,{className:"Modal",show:t,onHide:this.handleClose,onShow:this.handleOpen},o.a.createElement(T.a.Header,{closeButton:!0},o.a.createElement(T.a.Title,null,"Edit Node")),o.a.createElement(T.a.Body,null,o.a.createElement("p",null,e.data("name")),this.topicOrResource()),o.a.createElement(T.a.Footer,null,o.a.createElement(M.a,{style:{backgroundColor:"#a9a8a8"},variant:"primary",type:"submit",onClick:this.handleSubmit},"Edit node")))):o.a.createElement("span",null)}}]),a}(n.Component));ye.defaultProps={addNode:function(){return alert("ERROR: addNode() invalid")},node:null,setNode:function(){return alert("ERROR: setNode() invalid")},updateEdges:function(){return alert("ERROR: updateEdgges() invalid")},removeNode:function(){return alert("ERROR: removeNode() invalid")}};var ke=ye,Ee=(a(888),function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={isOpen:!1},n.toggleModal=n.toggleModal.bind(Object(j.a)(n)),n}return Object(d.a)(a,null,[{key:"makeIokComponent",value:function(e,t){return o.a.createElement("a",{href:t},e)}},{key:"replaceUrlParam",value:function(e,t,a){var n=a;null==a&&(n="");var o=new RegExp("\\b(".concat(t,"=).*?(&|#|$)"));if(e.search(o)>=0)return e.replace(o,"$1".concat(n,"$2"));var r=e.replace(/[?#]$/,"");return"".concat(r+(r.indexOf("?")>0?"&":"?")+t,"=").concat(n)}}]),Object(d.a)(a,[{key:"toggleModal",value:function(){var e=this.state.isOpen;this.setState({isOpen:!e})}},{key:"render",value:function(){var e=this.state.isOpen;return o.a.createElement("div",null,o.a.createElement(M.a,{className:"btn btn-info btn-lg btn-mod",onClick:this.toggleModal},"List IoKs"),o.a.createElement(T.a,{className:"Modal",show:e,onHide:this.toggleModal},o.a.createElement(T.a.Header,{closeButton:!0},o.a.createElement(T.a.Title,null,"IoK Public Listing")),o.a.createElement(T.a.Body,null,o.a.createElement("ul",null,O.map((function(e){return o.a.createElement("li",{key:e.user},a.makeIokComponent(e.user,e.app))}))))))}}]),a}(n.Component)),Oe=(a(889),function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var n;Object(s.a)(this,a);var o=(n=t.call(this,e)).props,r=o.onSaveClick,l=o.onDeleteClick,c=o.loadGraphHandler;return n.onSaveClick=r,n.onDeleteClick=l,n.loadGraphHandler=c,n.toggleSaveModal=n.toggleSaveModal.bind(Object(j.a)(n)),n.toggleDeleteModal=n.toggleDeleteModal.bind(Object(j.a)(n)),n.onMetaClick=n.onMetaClick.bind(Object(j.a)(n)),n.onRegroupClick=n.onRegroupClick.bind(Object(j.a)(n)),n.onAddClick=n.onAddClick.bind(Object(j.a)(n)),n.addNodeToCy=n.addNodeToCy.bind(Object(j.a)(n)),n.downloadGraph=n.downloadGraph.bind(Object(j.a)(n)),n.onFileUploadHandler=n.onFileUploadHandler.bind(Object(j.a)(n)),n.removeNodeFromCy=n.removeNodeFromCy.bind(Object(j.a)(n)),n.updateEdgesFromCy=n.updateEdgesFromCy.bind(Object(j.a)(n)),n.state={drawEnabled:!1,showDeleteModal:!1,showSaveModal:!1},n}return Object(d.a)(a,[{key:"onMetaClick",value:function(){var e=this.state.cy;ie(e)}},{key:"onRegroupClick",value:function(){var e=this.state.cy;ce(e)}},{key:"onAddClick",value:function(){var e=String(Math.ceil(1e6*Math.random())),t={node_type:1,name:"rand-".concat(e)};this.addNodeToCy(t)}},{key:"onFileUploadHandler",value:function(e){var t=this,a=new FileReader;a.onload=function(e){Y.info(e.target.result);try{var a=JSON.parse(e.target.result);t.loadGraphHandler(a)}catch(n){Y.error(n),alert("Invalid JSON file")}},a.readAsText(e.target.files[0])}},{key:"downloadGraph",value:function(){var e=this.state.cy,t=oe(e),a="data:text/json;charset=utf-8,".concat(encodeURIComponent(JSON.stringify(t))),n=document.createElement("a");n.setAttribute("href",a),n.setAttribute("download","graph.json"),document.body.appendChild(n),n.click(),n.remove()}},{key:"addNodeToCy",value:function(e){var t=this.state.cy,a=J.sha256.create();a.update(JSON.stringify(e));var n=Object(i.a)(Object(i.a)({},e),{},{id:a.hex()});return"name"in e||(n=Object(i.a)(Object(i.a)({},n),{},{name:"res-".concat(n.id.substring(0,10))})),Y.info("DATA",n),function(e,t){try{return e.add({group:"nodes",data:t})}catch(a){return console.error(a),alert("Failed to add node. Check for ID collisions"),null}}(t,n)}},{key:"toggleDeleteModal",value:function(){var e=this.state.showDeleteModal;this.setState({showDeleteModal:!e})}},{key:"toggleSaveModal",value:function(){var e=this.state.showSaveModal;this.setState({showSaveModal:!e})}},{key:"removeNodeFromCy",value:function(e){this.state.cy.remove(e)}},{key:"updateEdgesFromCy",value:function(e,t){var a=this.state.cy;e.incomers((function(e){return e.isNode()})).map((function(e){return a.add({group:"edges",data:{source:e.id(),target:t.id()}})})),e.outgoers((function(e){return e.isNode()})).map((function(e){return a.add({group:"edges",data:{source:t.id(),target:e.id()}})})),a.remove(e.connectedEdges())}},{key:"render",value:function(){var e=this,t=this.props,n=t.currNode,r=t.graphLoaded,l=t.guestMode,c=t.setCurrNode,i=this.state,s=i.showDeleteModal,d=i.showSaveModal,u=i.drawEnabled,p=n,h=p&&Object.keys(p).length>0?p.data():{name:"Overview",data:"Index of Knowledge (IoK) is a curated collection of resources for blockchain, grouped by topic and topologically ordered by pedagogical dependency.",resource_type:1,node_type:2},f="";h.node_type===g&&(f="NOTE: Resource node. Displaying own contents");var b=[h];h.node_type===m&&(b=p.incomers((function(e){return e.isNode()})).map((function(e){return e.data()})));var v,y=[],k=[],E=[],O=Object(A.a)(b);try{for(O.s();!(v=O.n()).done;){var C=v.value;C.node_type===m?y.push(o.a.createElement("li",{key:C.name},C.name)):C.node_type===g&&(1===C.resource_type?k.push(o.a.createElement("li",{key:C.data},C.data.text)):E.push(o.a.createElement("li",{key:C.data},o.a.createElement("a",{href:C.data.link},C.data.text))))}}catch(S){O.e(S)}finally{O.f()}return p||E.push(o.a.createElement("li",{key:"dummy"},o.a.createElement("a",{href:"."},"Resource links appear here!"))),o.a.createElement("div",null,o.a.createElement(T.a,{className:"Modal",show:s,onHide:this.toggleDeleteModal},o.a.createElement(T.a.Header,null,o.a.createElement(T.a.Title,null,"Delete your IoK?")),o.a.createElement(T.a.Body,null,"This will delete all your IoK data from your Blockstack data locker."),o.a.createElement(T.a.Footer,null,o.a.createElement(M.a,{className:"btn btn-info btn-lg btn-delete",onClick:function(){e.onDeleteClick(),e.toggleDeleteModal()}},"Delete"))),o.a.createElement(T.a,{className:"Modal",show:d,onHide:this.toggleSaveModal},o.a.createElement(T.a.Header,null,o.a.createElement(T.a.Title,null,"Save your IoK?")),o.a.createElement(T.a.Body,null,"This will save your IoK data to your Blockstack data locker, potentially overwriting previous versions."),o.a.createElement(T.a.Footer,null,o.a.createElement(M.a,{className:"btn btn-info btn-lg btn-save",onClick:function(){e.onSaveClick(),e.toggleSaveModal()}},"Save"))),o.a.createElement("div",{id:"cytext",className:"iok-text"},o.a.createElement("div",null,o.a.createElement("h2",{className:"breaking",id:"nodetitle"},h.name),o.a.createElement("p",{className:"breaking",id:"nodeid"},h.id),o.a.createElement("p",{id:"nodesubtitle"},f),o.a.createElement("hr",{className:"hr-sep"}),0!==k.length&&o.a.createElement("div",null,o.a.createElement("h5",null,"Description(s)"),o.a.createElement("ul",{id:"nodedescs"},k)),0!==E.length&&o.a.createElement("div",null,o.a.createElement("h5",null,"Links"),o.a.createElement("ul",{id:"nodelinks"},E)),0!==y.length&&o.a.createElement("div",null,o.a.createElement("h5",null,"Dependencies"),o.a.createElement("ul",{id:"nodedeps"},y)),o.a.createElement("hr",{className:"hr-sep"}),o.a.createElement("div",null,o.a.createElement("div",{className:"edit-div"},o.a.createElement("h5",null,"Edit"),o.a.createElement(ke,{node:p,addNode:this.addNodeToCy,removeNode:this.removeNodeFromCy,setNode:c,updateEdges:this.updateEdgesFromCy}),o.a.createElement(me,{addNode:this.addNodeToCy}),o.a.createElement("button",{type:"button",className:"btn btn-info btn-lg btn-util",onClick:function(){a.onDrawClick(),e.setState({drawEnabled:!u})}},"Turn ".concat(u?"OFF":"ON"," edge drawing")),!r||l?o.a.createElement("div",null):o.a.createElement("div",null,o.a.createElement("button",{type:"button",className:"btn btn-info btn-lg btn-save",onClick:this.toggleSaveModal},"Save"),o.a.createElement("button",{type:"button",className:"btn btn-info btn-lg btn-delete",onClick:this.toggleDeleteModal},"Delete"))),o.a.createElement("div",{className:"misc-div"},o.a.createElement("h5",null,"Misc"),o.a.createElement(Ee,null),r?o.a.createElement("button",{type:"button",id:"downloadButton",className:"btn btn-info btn-lg btn-util",onClick:this.downloadGraph},"Download"):o.a.createElement("div",null),o.a.createElement("input",{className:"btn btn-info btn-lg btn-upload",type:"file",name:"file",onChange:this.onFileUploadHandler}))))))}}],[{key:"getDerivedStateFromProps",value:function(e){return{cy:e.cy}}},{key:"onDrawClick",value:function(){ee?(Z.disableDrawMode(),Z.disable(),ee=!1):(Z.enable(),Z.enableDrawMode(),ee=!0)}}]),a}(n.Component));Oe.defaultProps={onSaveClick:function(){return alert("ERROR: onSaveClick() invalid")},onDeleteClick:function(){return alert("ERROR: onDeleteClick() invalid")},loadGraphHandler:function(){return alert("ERROR: loadGraphHandler() invalid")},cy:{},currNode:null,graphLoaded:!1,guestMode:!1,setCurrNode:function(){return alert("ERROR: setCurrNode() invalid")}};var Ce=Oe,Se="storage.localstorage",Ne="localgraph",we=function(e,t,a){try{var n=JSON.stringify(e);localStorage.setItem(Ne,n),localStorage.setItem("storagetype",t);var o=JSON.stringify(a);localStorage.setItem("storageoptions",o),Y.info(Se,"localstorage save successful")}catch(r){}};a(890);G.a.use(I.a),G.a.use(x.a),G.a.use(P.a);var je=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var n;Object(s.a)(this,a);var o=(n=t.call(this,e)).props,r=o.storage,l=o.options;return Y.info("storage/options"),Y.info(r),Y.info(l),n.userSession=new h.UserSession({appConfig:y}),n.state={storage:r,options:l,graphLoaded:!1,unableToLoadGraph:!1,selectedNode:null,timerID:0},n.loadGraph=n.loadGraph.bind(Object(j.a)(n)),n.saveGraph=n.saveGraph.bind(Object(j.a)(n)),n.deleteGraph=n.deleteGraph.bind(Object(j.a)(n)),n.signOut=n.signOut.bind(Object(j.a)(n)),n.changeLoadUser=n.changeLoadUser.bind(Object(j.a)(n)),n.loadDefaultGraph=n.loadDefaultGraph.bind(Object(j.a)(n)),n.loadEmptyGraph=n.loadEmptyGraph.bind(Object(j.a)(n)),n.loadGraphFromFile=n.loadGraphFromFile.bind(Object(j.a)(n)),n.onSuccessLoadGraph=n.onSuccessLoadGraph.bind(Object(j.a)(n)),n.onErrorLoadGraph=n.onErrorLoadGraph.bind(Object(j.a)(n)),n.periodicallySaveCache=n.periodicallySaveCache.bind(Object(j.a)(n)),n}return Object(d.a)(a,null,[{key:"overrideGutterStyle",value:function(){return{width:"8px",height:"100vh","background-color":"#18191c"}}}]),Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=G()({container:document.getElementById("cy"),layout:{name:"dagre",animate:!0},style:S});this.setState({cy:t},(function(){!function(e,t){e.on("tap","node",(function(a){var n=a.target;ue(n),t(n),fe(e,n)}))}(t,(function(t){e.setState({selectedNode:t})})),function(e){(Z=e.edgehandles({preview:!0,noEdgeEventsInDraw:!0,snap:!0,handleNodes:"node"})).disableDrawMode(),Z.disable(),e.on("ehcomplete",(function(t,a,n,o){Y.info(X,"Added edge..."),Y.info(X,"source:",a),Y.info(X,"target:",n),Y.info(X,"eles:",e.elements().length)}))}(t),e.loadGraph();var a=e.state.timerID;clearInterval(a);var n=setInterval(e.periodicallySaveCache,1e3);e.setState({timerID:n})}))}},{key:"onSuccessLoadGraph",value:function(e){var t=this.state,a=t.cy,n=t.storage,o=t.options;Y.info(e),Y.info(a),a.json(e),Y.info("Cy currently size",a.elements().length),ce(a,!1),ce(a),this.setState({graphLoaded:!0}),we(e,n,o)}},{key:"onErrorLoadGraph",value:function(e){Y.error("Failed to load graph",e);var t=this.state.options;this.setState({unableToLoadGraph:!0,options:Object(i.a)(Object(i.a)({},t),{},{loaduser:"default"})})}},{key:"periodicallySaveCache",value:function(){var e=this.state,t=e.cy,a=e.storage,n=e.options,o=re(t);we(o,a,n)}},{key:"changeLoadUser",value:function(e){var t=this.state.options;this.setState({options:Object(i.a)(Object(i.a)({},t),{},{loaduser:e})})}},{key:"loadGraph",value:function(){var e,t,a,n=this.state,o=n.storage,r=n.options,l=function(e){Y.info(Se,"Loading from localstorage");var t=localStorage.getItem(Ne),a=localStorage.getItem("storagetype"),n=localStorage.getItem("storageoptions");try{if(t&&a&&n){var o=JSON.parse(t);if(null!==o.elements&&o.elements.nodes.length>0&&o.elements.edges.length>0){var r=JSON.parse(n);return Y.info(Se,"Got from graph from localstorage"),Y.info(Se,o),Y.info(Se,a),Y.info(Se,r),{graph:o,storage:a,options:r}}e("cached graph is empty, skipping")}e("cache is empty")}catch(l){e(l)}return{}}((function(e){Y.error(e,"cache invalid")}));if(Object.keys(l).length>0){if(l.storage===o&&JSON.stringify(l.options)===JSON.stringify(r))return Y.info("Load request cache"),void this.onSuccessLoadGraph(l.graph);if(o===k&&JSON.stringify(r)===JSON.stringify(E))return Y.info("Load DEFL request cache"),void this.onSuccessLoadGraph(l.graph)}switch(o){case b:e=r.hash,t=this.onSuccessLoadGraph,a=this.onErrorLoadGraph,Y.info("storage.ipfs","Loading from IPFS",e),fetch("https://ipfs.io/ipfs/"+e).then((function(e){return e.json()})).then((function(e){t(e)})).catch((function(e){a(e)}));break;case f:!function(e,t,a,n){Y.info("GOT FUNCTIONS",a,n),Y.info("storage.blockstack","Loading",t,"'s data");var o={decrypt:!1,username:t};e.getFile("graph.json",o).then((function(e){if(e&&e.length>0){var t=JSON.parse(e);a(t)}else n()})).catch((function(e){n(e)}))}(this.userSession,r.loaduser,this.onSuccessLoadGraph,this.onErrorLoadGraph)}}},{key:"loadGraphFromFile",value:function(e){var t=this.state,a=t.cy,n=t.options;try{a.json({elements:e,style:S}),ce(a,!1),ce(a),this.setState({graphLoaded:!0})}catch(o){alert("Invalid graph format"),this.setState({unableToLoadGraph:!0,options:Object(i.a)(Object(i.a)({},n),{},{loaduser:"default"})})}}},{key:"saveGraph",value:function(){var e=this,t=this.state,a=t.cy,n=t.storage,o=t.options,r=re(a);switch(we(r,n,o),n){case b:!function(e,t){var a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};Y.info("GRAPH",e),fetch("https://us-central1-index-of-knowledge.cloudfunctions.net/storeGraph",a).then((function(e){return Y.info("RESPONSE",e),e.json()})).then((function(e){return t(e.IpfsHash)})).catch((function(e){return Y.error(e)}))}(r,(function(t){e.setState({options:{hash:t}}),alert(t)}));break;case f:!function(e,t){Y.info("storage.blockstack","SAVING...",e),t.putFile("graph.json",JSON.stringify(e),{encrypt:!1}).finally((function(){Y.info("Saved")}))}(r,this.userSession)}}},{key:"deleteGraph",value:function(){var e=this,t=this.state,a=t.cy,n=t.storage,o=t.options;switch(n){case b:Y.error("IPFS delete not implemented");break;case f:this.userSession.deleteFile("graph.json").finally((function(){a.json({elements:[],style:S}),e.setState({graphLoaded:!1,unableToLoadGraph:!0,options:Object(i.a)(Object(i.a)({},o),{},{loaduser:"default"})}),e.loadGraph()}))}localStorage.removeItem(Ne),localStorage.removeItem("storagetype"),localStorage.removeItem("storageoptions")}},{key:"signOut",value:function(e){this.state.storage===f&&(e.preventDefault(),this.userSession.signUserOut(),window.location="/?storage=".concat(f))}},{key:"loadEmptyGraph",value:function(){var e=this.state.cy;this.setState({graphLoaded:!0,unableToLoadGraph:!1}),ce(e)}},{key:"loadDefaultGraph",value:function(){var e=this.state.cy;e.json({elements:C,style:S}),this.setState({graphLoaded:!0,unableToLoadGraph:!1}),ce(e,!1),ce(e)}},{key:"NavOrNot",value:function(){var e=this.state,t=e.storage,a=e.options;return t===b?null:o.a.createElement(U,{username:a.username,loadName:a.loaduser,changeLoadUser:this.changeLoadUser,signOut:this.signOut})}},{key:"render",value:function(){var e=this,t=this.state,n=t.cy,r=t.storage,l=t.options,c=t.graphLoaded,i=t.unableToLoadGraph,s=t.selectedNode,d=l.guest;return o.a.createElement("div",{className:"SignedIn"},o.a.createElement(T.a,{className:"Modal",show:!c&&!i},o.a.createElement(T.a.Header,null,o.a.createElement(T.a.Title,null,"Loading graph from ".concat(r))),o.a.createElement(T.a.Footer,null)),o.a.createElement(T.a,{className:"Modal",show:i,onHide:this.loadEmptyGraph},o.a.createElement(T.a.Header,null,o.a.createElement(T.a.Title,null,"Unable to fetch graph")),o.a.createElement(T.a.Footer,null,o.a.createElement(M.a,{style:{backgroundColor:"#a9a8a8"},variant:"secondary",type:"submit",onClick:this.loadEmptyGraph},"Load empty"),o.a.createElement(M.a,{style:{backgroundColor:"#a9a8a8"},variant:"primary",type:"submit",onClick:this.loadDefaultGraph},"Load default"))),o.a.createElement(U,{storage:r,options:l,changeLoadUser:this.changeLoadUser,signOut:this.signOut}),o.a.createElement(R.a,{className:"split-parent",sizes:[60,40],gutterStyle:a.overrideGutterStyle,gutterAlign:"center",direction:"horizontal",cursor:"col-resize"},o.a.createElement("div",{className:"split split-horizontal"},o.a.createElement("div",{className:"split content",id:"cy"},o.a.createElement("p",{className:"hidden-msg"},"p.s. refresh if the graph does not load"),o.a.createElement("div",{className:"cy-overlay"},o.a.createElement(M.a,{className:"btn btn-info btn-lg btn-util",onClick:function(){return ie(n)}},"Toggle meta-graph"),o.a.createElement(M.a,{className:"btn btn-info btn-lg btn-util",onClick:function(){return ce(n,!1)}},"Regroup dagre"),o.a.createElement(M.a,{className:"btn btn-info btn-lg btn-util",onClick:function(){return ce(n)}},"Regroup cola")))),o.a.createElement("div",{className:"split split-horizontal"},o.a.createElement(Ce,{currNode:s,className:"split content",cy:n,onSaveClick:this.saveGraph,onDeleteClick:this.deleteGraph,loadGraphHandler:this.loadGraphFromFile,guestMode:d,graphLoaded:c,setCurrNode:function(t){return e.setState({selectedNode:t})}}))))}}]),a}(n.Component);je.defaultProps={storage:k,options:E};var Re=je,Te=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(s.a)(this,a),e=t.call(this);var n=a.parseParams(),o=n.storage,r=n.options;return e.state={storage:o,options:r},e.userSession=new h.UserSession,Y.info(o,r),e}return Object(d.a)(a,null,[{key:"changeToGuestMode",value:function(){var e=new URL(window.location.href);e.searchParams.set("guest","true"),window.location.href=e}},{key:"parseParams",value:function(){var e=new URLSearchParams(window.location.search),t=k,a=JSON.parse(JSON.stringify(E));if(e.has("storage"))switch(e.get("storage")){case f:t=f,e.has("guest")&&"true"===e.get("guest")?(a.guest=!0,a.username="guest"):a.guest=!1,e.has("loaduser")&&(a.loaduser=e.get("loaduser"));break;case b:t=b,e.has("hash")&&(a.hash=e.get("hash"));break;default:t=k,a=JSON.parse(JSON.stringify(E))}return{storage:t,options:a}}}]),Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.state,a=t.storage,n=t.options,o=this.userSession;a!==f||"guest"in n||"loaduser"in n||n.guest||n.loaduser||o.isUserSignedIn()||!o.isSignInPending()||o.handlePendingSignIn().then((function(t){if(!t.username)throw new Error("This app requires a username.");e.setState({options:Object(i.a)(Object(i.a)({},n),{},{username:t.username})}),window.location.href="/"}))}},{key:"render",value:function(){var e=this.state,t=e.storage,n=e.options;return Y.trace("Re-render App.jsx:",t,n),o.a.createElement("div",{className:"site-wrapper"},t===b||n.guest||this.userSession.isUserSignedIn()?o.a.createElement(Re,{storage:t,options:n}):o.a.createElement(w,{guestModeHandler:a.changeToGuestMode}))}}]),a}(n.Component);a(891),a(892),a(893);l.a.render(o.a.createElement(c.a,null,o.a.createElement(Te,null)),document.getElementById("root"))}},[[414,1,2]]]);
//# sourceMappingURL=main.2a070e27.chunk.js.map